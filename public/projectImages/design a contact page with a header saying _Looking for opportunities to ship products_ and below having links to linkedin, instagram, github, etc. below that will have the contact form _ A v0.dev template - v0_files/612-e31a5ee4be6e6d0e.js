(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{81489:(t,e,i)=>{"use strict";i.r(e),i.d(e,{GeistProvider:()=>w});var s=i(19054),r=i(28757);let l=["light","dark"],n="(prefers-color-scheme: dark)",o="undefined"==typeof window,a=(0,r.createContext)(void 0),h=t=>(0,r.useContext)(a)?r.createElement(r.Fragment,null,t.children):r.createElement(c,t),u=["light","dark"],c=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:i=!0,enableColorScheme:s=!0,storageKey:o="theme",themes:h=u,defaultTheme:c=i?"system":"light",attribute:v="data-theme",value:m,children:y,nonce:x})=>{let[b,_]=(0,r.useState)(()=>d(o,c)),[S,w]=(0,r.useState)(()=>d(o)),T=m?Object.values(m):h,k=(0,r.useCallback)(t=>{let r=t;if(!r)return;"system"===t&&i&&(r=g());let n=m?m[r]:r,o=e?p():null,a=document.documentElement;if("class"===v?(a.classList.remove(...T),n&&a.classList.add(n)):n?a.setAttribute(v,n):a.removeAttribute(v),s){let t=l.includes(c)?c:null,e=l.includes(r)?r:t;a.style.colorScheme=e}null==o||o()},[]),A=(0,r.useCallback)(t=>{_(t);try{localStorage.setItem(o,t)}catch(t){}},[t]),L=(0,r.useCallback)(e=>{w(g(e)),"system"===b&&i&&!t&&k("system")},[b,t]);(0,r.useEffect)(()=>{let t=window.matchMedia(n);return t.addListener(L),L(t),()=>t.removeListener(L)},[L]),(0,r.useEffect)(()=>{let t=t=>{t.key===o&&A(t.newValue||c)};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[A]),(0,r.useEffect)(()=>{k(null!=t?t:b)},[t,b]);let z=(0,r.useMemo)(()=>({theme:b,setTheme:A,forcedTheme:t,resolvedTheme:"system"===b?S:b,themes:i?[...h,"system"]:h,systemTheme:i?S:void 0}),[b,A,t,S,i,h]);return r.createElement(a.Provider,{value:z},r.createElement(f,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:i,enableColorScheme:s,storageKey:o,themes:h,defaultTheme:c,attribute:v,value:m,children:y,attrs:T,nonce:x}),y)},f=(0,r.memo)(({forcedTheme:t,storageKey:e,attribute:i,enableSystem:s,enableColorScheme:o,defaultTheme:a,value:h,attrs:u,nonce:c})=>{let f="system"===a,d="class"===i?`var d=document.documentElement,c=d.classList;c.remove(${u.map(t=>`'${t}'`).join(",")});`:`var d=document.documentElement,n='${i}',s='setAttribute';`,p=o?l.includes(a)&&a?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${a}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",g=(t,e=!1,s=!0)=>{let r=h?h[t]:t,n=e?t+"|| ''":`'${r}'`,a="";return o&&s&&!e&&l.includes(t)&&(a+=`d.style.colorScheme = '${t}';`),"class"===i?a+=e||r?`c.add(${n})`:"null":r&&(a+=`d[s](n,${n})`),a},v=t?`!function(){${d}${g(t)}}()`:s?`!function(){try{${d}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${f})){var t='${n}',m=window.matchMedia(t);if(m.media!==t||m.matches){${g("dark")}}else{${g("light")}}}else if(e){${h?`var x=${JSON.stringify(h)};`:""}${g(h?"x[e]":"e",!0)}}${f?"":"else{"+g(a,!1,!1)+"}"}${p}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${e}');if(e){${h?`var x=${JSON.stringify(h)};`:""}${g(h?"x[e]":"e",!0)}}else{${g(a,!1,!1)};}${p}}catch(t){}}();`;return r.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:v}})},()=>!0),d=(t,e)=>{let i;if(!o){try{i=localStorage.getItem(t)||void 0}catch(t){}return i||e}},p=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},g=t=>(t||(t=window.matchMedia(n)),t.matches?"dark":"light"),v=(0,r.createContext)({forceShowTooltips:!1,setForceShowTooltips:()=>{}});function m(t){let{children:e}=t,[i,l]=(0,r.useState)(!1),n=(0,r.useMemo)(()=>({forceShowTooltips:i,setForceShowTooltips:l}),[i]);return(0,s.jsx)(v.Provider,{value:n,children:e})}var y=i(76059),x=i.n(y),b=i(46385),_=i.n(b);let S={light:"light-theme",dark:"dark-theme"};function w(t){let{children:e,storageKey:i="geist-theme",...r}=t;return x(),_(),(0,s.jsx)(h,{attribute:"class",disableTransitionOnChange:!0,storageKey:i,value:S,...r,children:(0,s.jsx)(m,{children:e})})}},47162:(t,e,i)=>{var s=i(41029).Symbol;t.exports=s},40359:(t,e,i)=>{var s=i(47162),r=i(40235),l=i(47958),n=s?s.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":n&&n in Object(t)?r(t):l(t)}},64009:(t,e,i)=>{var s=i(59654),r=/^\s+/;t.exports=function(t){return t?t.slice(0,s(t)+1).replace(r,""):t}},58589:(t,e,i)=>{var s="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g;t.exports=s},40235:(t,e,i)=>{var s=i(47162),r=Object.prototype,l=r.hasOwnProperty,n=r.toString,o=s?s.toStringTag:void 0;t.exports=function(t){var e=l.call(t,o),i=t[o];try{t[o]=void 0;var s=!0}catch(t){}var r=n.call(t);return s&&(e?t[o]=i:delete t[o]),r}},47958:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},41029:(t,e,i)=>{var s=i(58589),r="object"==typeof self&&self&&self.Object===Object&&self,l=s||r||Function("return this")();t.exports=l},59654:t=>{var e=/\s/;t.exports=function(t){for(var i=t.length;i--&&e.test(t.charAt(i)););return i}},97117:(t,e,i)=>{var s=i(31967),r=i(74499),l=i(86942),n=Math.max,o=Math.min;t.exports=function(t,e,i){var a,h,u,c,f,d,p=0,g=!1,v=!1,m=!0;if("function"!=typeof t)throw TypeError("Expected a function");function y(e){var i=a,s=h;return a=h=void 0,p=e,c=t.apply(s,i)}function x(t){var i=t-d,s=t-p;return void 0===d||i>=e||i<0||v&&s>=u}function b(){var t,i,s,l=r();if(x(l))return _(l);f=setTimeout(b,(t=l-d,i=l-p,s=e-t,v?o(s,u-i):s))}function _(t){return(f=void 0,m&&a)?y(t):(a=h=void 0,c)}function S(){var t,i=r(),s=x(i);if(a=arguments,h=this,d=i,s){if(void 0===f)return p=t=d,f=setTimeout(b,e),g?y(t):c;if(v)return clearTimeout(f),f=setTimeout(b,e),y(d)}return void 0===f&&(f=setTimeout(b,e)),c}return e=l(e)||0,s(i)&&(g=!!i.leading,u=(v="maxWait"in i)?n(l(i.maxWait)||0,e):u,m="trailing"in i?!!i.trailing:m),S.cancel=function(){void 0!==f&&clearTimeout(f),p=0,a=d=h=f=void 0},S.flush=function(){return void 0===f?c:_(r())},S}},31967:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},18649:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},84967:(t,e,i)=>{var s=i(40359),r=i(18649);t.exports=function(t){return"symbol"==typeof t||r(t)&&"[object Symbol]"==s(t)}},74499:(t,e,i)=>{var s=i(41029);t.exports=function(){return s.Date.now()}},59479:(t,e,i)=>{var s=i(97117),r=i(31967);t.exports=function(t,e,i){var l=!0,n=!0;if("function"!=typeof t)throw TypeError("Expected a function");return r(i)&&(l="leading"in i?!!i.leading:l,n="trailing"in i?!!i.trailing:n),s(t,e,{leading:l,maxWait:e,trailing:n})}},86942:(t,e,i)=>{var s=i(64009),r=i(31967),l=i(84967),n=0/0,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,h=/^0o[0-7]+$/i,u=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(l(t))return n;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=s(t);var i=a.test(t);return i||h.test(t)?u(t.slice(2),i?2:8):o.test(t)?n:+t}},5404:(t,e,i)=>{"use strict";i.d(e,{default:()=>r.a});var s=i(64623),r=i.n(s)},94248:(t,e,i)=>{"use strict";i.d(e,{default:()=>r.a});var s=i(79691),r=i.n(s)},64623:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return l}});let s=i(67841);i(19054),i(28757);let r=s._(i(4873));function l(t,e){var i;let s={loading:t=>{let{error:e,isLoading:i,pastDelay:s}=t;return null}};"function"==typeof t&&(s.loader=t);let l={...s,...e};return(0,r.default)({...l,modules:null==(i=l.loadableGenerated)?void 0:i.modules})}("function"==typeof e.default||"object"==typeof e.default&&null!==e.default)&&void 0===e.default.__esModule&&(Object.defineProperty(e.default,"__esModule",{value:!0}),Object.assign(e.default,e),t.exports=e.default)},43226:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"BailoutToCSR",{enumerable:!0,get:function(){return r}});let s=i(79109);function r(t){let{reason:e,children:i}=t;if("undefined"==typeof window)throw new s.BailoutToCSRError(e);return i}},4873:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return h}});let s=i(19054),r=i(28757),l=i(43226),n=i(60778);function o(t){return{default:t&&"default"in t?t.default:t}}let a={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},h=function(t){let e={...a,...t},i=(0,r.lazy)(()=>e.loader().then(o)),h=e.loading;function u(t){let o=h?(0,s.jsx)(h,{isLoading:!0,pastDelay:!0,error:null}):null,a=e.ssr?(0,s.jsxs)(s.Fragment,{children:["undefined"==typeof window?(0,s.jsx)(n.PreloadChunks,{moduleIds:e.modules}):null,(0,s.jsx)(i,{...t})]}):(0,s.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(i,{...t})});return(0,s.jsx)(r.Suspense,{fallback:o,children:a})}return u.displayName="LoadableComponent",u}},60778:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"PreloadChunks",{enumerable:!0,get:function(){return n}});let s=i(19054),r=i(87868),l=i(34081);function n(t){let{moduleIds:e}=t;if("undefined"!=typeof window)return null;let i=(0,r.getExpectedRequestStore)("next/dynamic preload"),n=[];if(i.reactLoadableManifest&&e){let t=i.reactLoadableManifest;for(let i of e){if(!t[i])continue;let e=t[i].files;n.push(...e)}}return 0===n.length?null:(0,s.jsx)(s.Fragment,{children:n.map(t=>{let e=i.assetPrefix+"/_next/"+encodeURI(t);return t.endsWith(".css")?(0,s.jsx)("link",{precedence:"dynamic",href:e,rel:"stylesheet",as:"style"},t):((0,l.preload)(e,{as:"script",fetchPriority:"low"}),null)})})}},46385:t=>{t.exports={style:{fontFamily:"'geistMonoFont', ui-monospace, SFMono-Regular, Roboto Mono, Menlo, Monaco, Liberation Mono, DejaVu Sans Mono, Courier New, monospace"},className:"__className_cd6509",variable:"__variable_cd6509"}},76059:t=>{t.exports={style:{fontFamily:"'geistSansFont', arial"},className:"__className_deb525",variable:"__variable_deb525"}},52357:(t,e,i)=>{"use strict";let s;i.d(e,{InternalAIProvider:()=>Y,mj:()=>H});var r=i(28757);class l{constructor(t){this.selfOptions=t||{},this.pipes={}}options(t){return t&&(this.selfOptions=t),this.selfOptions}pipe(t,e){let i=e;if("string"==typeof t){if(void 0===i)return this.pipes[t];this.pipes[t]=i}if(t&&t.name){if((i=t).processor===this)return i;this.pipes[i.name]=i}return i.processor=this,i}process(t,e){let i,s=t;s.options=this.options();let r=e||t.pipe||"default";for(;r;)void 0!==s.nextAfterChildren&&(s.next=s.nextAfterChildren,s.nextAfterChildren=null),"string"==typeof r&&(r=this.pipe(r)),r.process(s),i=r,r=null,s&&s.next&&(r=(s=s.next).pipe||i);return s.hasResult?s.result:void 0}}class n{constructor(t){this.name=t,this.filters=[]}process(t){if(!this.processor)throw Error("add this pipe to a processor before using it");let e=this.debug,i=this.filters.length;for(let s=0;s<i;s++){let i=this.filters[s];if(e&&this.log(`filter: ${i.filterName}`),i(t),"object"==typeof t&&t.exiting){t.exiting=!1;break}}!t.next&&this.resultCheck&&this.resultCheck(t)}log(t){console.log(`[jsondiffpatch] ${this.name} pipe, ${t}`)}append(...t){return this.filters.push(...t),this}prepend(...t){return this.filters.unshift(...t),this}indexOf(t){if(!t)throw Error("a filter name is required");for(let e=0;e<this.filters.length;e++)if(this.filters[e].filterName===t)return e;throw Error(`filter not found: ${t}`)}list(){return this.filters.map(t=>t.filterName)}after(t,...e){let i=this.indexOf(t);return this.filters.splice(i+1,0,...e),this}before(t,...e){let i=this.indexOf(t);return this.filters.splice(i,0,...e),this}replace(t,...e){let i=this.indexOf(t);return this.filters.splice(i,1,...e),this}remove(t){let e=this.indexOf(t);return this.filters.splice(e,1),this}clear(){return this.filters.length=0,this}shouldHaveResult(t){if(!1===t){this.resultCheck=null;return}if(!this.resultCheck)return this.resultCheck=t=>{if(!t.hasResult){console.log(t);let e=Error(`${this.name} failed`);throw e.noResult=!0,e}},this}}class o{setResult(t){return this.result=t,this.hasResult=!0,this}exit(){return this.exiting=!0,this}push(t,e){return t.parent=this,void 0!==e&&(t.childName=e),t.root=this.root||this,t.options=t.options||this.options,this.children?(this.children[this.children.length-1].next=t,this.children.push(t)):(this.children=[t],this.nextAfterChildren=this.next||null,this.next=t),t.next=this,this}}function a(t){if("object"!=typeof t)return t;if(null===t)return null;if(Array.isArray(t))return t.map(a);if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return function(t){let e=/^\/(.*)\/([gimyu]*)$/.exec(t.toString());return new RegExp(e[1],e[2])}(t);let e={};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=a(t[i]));return e}class h extends o{constructor(t,e){super(),this.left=t,this.right=e,this.pipe="diff"}setResult(t){if(this.options.cloneDiffValues&&"object"==typeof t){let e="function"==typeof this.options.cloneDiffValues?this.options.cloneDiffValues:a;"object"==typeof t[0]&&(t[0]=e(t[0])),"object"==typeof t[1]&&(t[1]=e(t[1]))}return super.setResult(t)}}class u extends o{constructor(t,e){super(),this.left=t,this.delta=e,this.pipe="patch"}}class c extends o{constructor(t){super(),this.delta=t,this.pipe="reverse"}}let f=function(t){if(t.left===t.right){t.setResult(void 0).exit();return}if(void 0===t.left){if("function"==typeof t.right)throw Error("functions are not supported");t.setResult([t.right]).exit();return}if(void 0===t.right){t.setResult([t.left,0,0]).exit();return}if("function"==typeof t.left||"function"==typeof t.right)throw Error("functions are not supported");if(t.leftType=null===t.left?"null":typeof t.left,t.rightType=null===t.right?"null":typeof t.right,t.leftType!==t.rightType||"boolean"===t.leftType||"number"===t.leftType||("object"===t.leftType&&(t.leftIsArray=Array.isArray(t.left)),"object"===t.rightType&&(t.rightIsArray=Array.isArray(t.right)),t.leftIsArray!==t.rightIsArray)){t.setResult([t.left,t.right]).exit();return}t.left instanceof RegExp&&(t.right instanceof RegExp?t.setResult([t.left.toString(),t.right.toString()]).exit():t.setResult([t.left,t.right]).exit())};f.filterName="trivial";let d=function(t){if(void 0===t.delta){t.setResult(t.left).exit();return}if(t.nested=!Array.isArray(t.delta),t.nested)return;let e=t.delta;if(1===e.length){t.setResult(e[0]).exit();return}if(2===e.length){if(t.left instanceof RegExp){let i=/^\/(.*)\/([gimyu]+)$/.exec(e[1]);if(i){t.setResult(new RegExp(i[1],i[2])).exit();return}}t.setResult(e[1]).exit();return}3===e.length&&0===e[2]&&t.setResult(void 0).exit()};d.filterName="trivial";let p=function(t){if(void 0===t.delta){t.setResult(t.delta).exit();return}if(t.nested=!Array.isArray(t.delta),t.nested)return;let e=t.delta;if(1===e.length){t.setResult([e[0],0,0]).exit();return}if(2===e.length){t.setResult([e[1],e[0]]).exit();return}3===e.length&&0===e[2]&&t.setResult([e[0]]).exit()};p.filterName="trivial";let g=t=>{let e;if(!t||!t.children)return;let i=t.children.length,s=t.result;for(let r=0;r<i;r++)void 0!==(e=t.children[r]).result&&((s=s||{})[e.childName]=e.result);s&&t.leftIsArray&&(s._t="a"),t.setResult(s).exit()};g.filterName="collectChildren";let v=t=>{let e,i;if(t.leftIsArray||"object"!==t.leftType)return;let s=t.left,r=t.right,l=t.options.propertyFilter;for(e in s)Object.prototype.hasOwnProperty.call(s,e)&&(!l||l(e,t))&&(i=new h(s[e],r[e]),t.push(i,e));for(e in r)Object.prototype.hasOwnProperty.call(r,e)&&(!l||l(e,t))&&void 0===s[e]&&(i=new h(void 0,r[e]),t.push(i,e));if(!t.children||0===t.children.length){t.setResult(void 0).exit();return}t.exit()};v.filterName="objects";let m=function(t){let e,i;if(!t.nested)return;let s=t.delta;if(!s._t){for(e in s)i=new u(t.left[e],s[e]),t.push(i,e);t.exit()}};m.filterName="objects";let y=function(t){let e;if(!t||!t.children||t.delta._t)return;let i=t.left,s=t.children.length;for(let r=0;r<s;r++){let s=(e=t.children[r]).childName;Object.prototype.hasOwnProperty.call(t.left,s)&&void 0===e.result?delete i[s]:i[s]!==e.result&&(i[s]=e.result)}t.setResult(i).exit()};y.filterName="collectChildren";let x=function(t){let e,i;if(!t.nested||t.delta._t)return;let s=t.delta;for(e in s)i=new c(s[e]),t.push(i,e);t.exit()};x.filterName="objects";let b=t=>{let e;if(!t||!t.children||t.delta._t)return;let i=t.children.length,s={};for(let r=0;r<i;r++){let i=(e=t.children[r]).childName;s[i]!==e.result&&(s[i]=e.result)}t.setResult(s).exit()};b.filterName="collectChildren";let _=function(t,e,i,s){return t[i]===e[s]},S=function(t,e,i,s){let r,l;let n=t.length,o=e.length,a=Array(n+1);for(r=0;r<n+1;r++)for(l=0,a[r]=Array(o+1);l<o+1;l++)a[r][l]=0;for(r=1,a.match=i;r<n+1;r++)for(l=1;l<o+1;l++)i(t,e,r-1,l-1,s)?a[r][l]=a[r-1][l-1]+1:a[r][l]=Math.max(a[r-1][l],a[r][l-1]);return a},w=function(t,e,i,s){let r=e.length,l=i.length,n={sequence:[],indices1:[],indices2:[]};for(;0!==r&&0!==l;)t.match(e,i,r-1,l-1,s)?(n.sequence.unshift(e[r-1]),n.indices1.unshift(r-1),n.indices2.unshift(l-1),--r,--l):t[r][l-1]>t[r-1][l]?--l:--r;return n},T={get:function(t,e,i,s){let r=s||{};return w(S(t,e,i||_,r),t,e,r)}};function k(t,e,i,s,r){let l=t[i],n=e[s];if(l===n)return!0;if("object"!=typeof l||"object"!=typeof n)return!1;let o=r.objectHash;if(!o)return r.matchByPosition&&i===s;r.hashCache1=r.hashCache1||[];let a=r.hashCache1[i];if(void 0===a&&(r.hashCache1[i]=a=o(l,i)),void 0===a)return!1;r.hashCache2=r.hashCache2||[];let h=r.hashCache2[s];return void 0===h&&(r.hashCache2[s]=h=o(n,s)),void 0!==h&&a===h}let A=function(t){let e,i,s,r,l;if(!t.leftIsArray)return;let n={objectHash:t.options&&t.options.objectHash,matchByPosition:t.options&&t.options.matchByPosition},o=0,a=0,u=t.left,c=t.right,f=u.length,d=c.length;for(f>0&&d>0&&!n.objectHash&&"boolean"!=typeof n.matchByPosition&&(n.matchByPosition=!function(t,e,i,s){for(let r=0;r<i;r++){let i=t[r];for(let t=0;t<s;t++){let s=e[t];if(r!==t&&i===s)return!0}}}(u,c,f,d));o<f&&o<d&&k(u,c,o,o,n);)r=new h(u[e=o],c[e]),t.push(r,e),o++;for(;a+o<f&&a+o<d&&k(u,c,f-1-a,d-1-a,n);)i=f-1-a,s=d-1-a,r=new h(u[i],c[s]),t.push(r,s),a++;if(o+a===f){if(f===d){t.setResult(void 0).exit();return}for(l=l||{_t:"a"},e=o;e<d-a;e++)l[e]=[c[e]];t.setResult(l).exit();return}if(o+a===d){for(l=l||{_t:"a"},e=o;e<f-a;e++)l[`_${e}`]=[u[e],0,0];t.setResult(l).exit();return}delete n.hashCache1,delete n.hashCache2;let p=u.slice(o,f-a),g=c.slice(o,d-a),v=T.get(p,g,k,n),m=[];for(l=l||{_t:"a"},e=o;e<f-a;e++)0>v.indices1.indexOf(e-o)&&(l[`_${e}`]=[u[e],0,0],m.push(e));let y=!0;t.options&&t.options.arrays&&!1===t.options.arrays.detectMove&&(y=!1);let x=!1;t.options&&t.options.arrays&&t.options.arrays.includeValueOnMove&&(x=!0);let b=m.length;for(e=o;e<d-a;e++){let a=v.indices2.indexOf(e-o);if(a<0){let a=!1;if(y&&b>0){for(let f=0;f<b;f++)if(k(p,g,(i=m[f])-o,e-o,n)){l[`_${i}`].splice(1,2,e,3),x||(l[`_${i}`][0]=""),s=e,r=new h(u[i],c[s]),t.push(r,s),m.splice(f,1),a=!0;break}}a||(l[e]=[c[e]])}else i=v.indices1[a]+o,s=v.indices2[a]+o,r=new h(u[i],c[s]),t.push(r,s)}t.setResult(l).exit()};A.filterName="arrays";let L={numerically:(t,e)=>t-e,numericallyBy:t=>(e,i)=>e[t]-i[t]},z=function(t){let e,i,s;if(!t.nested)return;let r=t.delta;if("a"!==r._t)return;let l=t.left,n=[],o=[],a=[];for(e in r)if("_t"!==e){if("_"===e[0]){let t=e;if(0===r[t][2]||3===r[t][2])n.push(parseInt(e.slice(1),10));else throw Error(`only removal or move can be applied at original array indices, invalid diff type: ${r[t][2]}`)}else{let t=e;1===r[t].length?o.push({index:parseInt(t,10),value:r[t][0]}):a.push({index:parseInt(t,10),delta:r[t]})}}for(e=(n=n.sort(L.numerically)).length-1;e>=0;e--){i=n[e];let t=r[`_${i}`],s=l.splice(i,1)[0];3===t[2]&&o.push({index:t[1],value:s})}let h=(o=o.sort(L.numericallyBy("index"))).length;for(e=0;e<h;e++){let t=o[e];l.splice(t.index,0,t.value)}let c=a.length;if(c>0)for(e=0;e<c;e++){let i=a[e];s=new u(l[i.index],i.delta),t.push(s,i.index)}if(!t.children){t.setResult(l).exit();return}t.exit()};z.filterName="arrays";let F=function(t){let e;if(!t||!t.children||"a"!==t.delta._t)return;let i=t.left,s=t.children.length;for(let r=0;r<s;r++)i[(e=t.children[r]).childName]=e.result;t.setResult(i).exit()};F.filterName="arraysCollectChildren";let E=function(t){let e,i;if(!t.nested){let e=t.delta;3===e[2]&&(t.newName=`_${e[1]}`,t.setResult([e[0],parseInt(t.childName.substring(1),10),3]).exit());return}let s=t.delta;if("a"===s._t){for(e in s)"_t"!==e&&(i=new c(s[e]),t.push(i,e));t.exit()}};E.filterName="arrays";let R=(t,e,i)=>{if("string"==typeof e&&"_"===e[0])return parseInt(e.substring(1),10);if(Array.isArray(i)&&0===i[2])return`_${e}`;let s=+e;for(let i in t){let r=t[i];if(Array.isArray(r)){if(3===r[2]){let t=parseInt(i.substring(1),10),l=r[1];if(l===+e)return t;t<=s&&l>s?s++:t>=s&&l<s&&s--}else 0===r[2]?parseInt(i.substring(1),10)<=s&&s++:1===r.length&&parseInt(i,10)<=s&&s--}}return s},j=t=>{let e;if(!t||!t.children)return;let i=t.delta;if("a"!==i._t)return;let s=t.children.length,r={_t:"a"};for(let l=0;l<s;l++){let s=(e=t.children[l]).newName;void 0===s&&(s=R(i,e.childName,e.result)),r[s]!==e.result&&(r[s]=e.result)}t.setResult(r).exit()};j.filterName="arraysCollectChildren";let C=function(t){t.left instanceof Date?(t.right instanceof Date?t.left.getTime()!==t.right.getTime()?t.setResult([t.left,t.right]):t.setResult(void 0):t.setResult([t.left,t.right]),t.exit()):t.right instanceof Date&&t.setResult([t.left,t.right]).exit()};C.filterName="dates";let O=null;function M(t,e){var i;if(!O){let s;if(null===(i=null==t?void 0:t.textDiff)||void 0===i?void 0:i.diffMatchPatch)s=new t.textDiff.diffMatchPatch;else{if(!e)return null;let t=Error("The diff-match-patch library was not provided. Pass the library in through the options or use the `jsondiffpatch/with-text-diffs` entry-point.");throw t.diff_match_patch_not_found=!0,t}O={diff:function(t,e){return s.patch_toText(s.patch_make(t,e))},patch:function(t,e){let i=s.patch_apply(s.patch_fromText(e),t);for(let t=0;t<i[1].length;t++)i[1][t]||(Error("text patch failed").textPatchFailed=!0);return i[0]}}}return O}let D=function(t){if("string"!==t.leftType)return;let e=t.left,i=t.right,s=t.options&&t.options.textDiff&&t.options.textDiff.minLength||60;if(e.length<s||i.length<s){t.setResult([e,i]).exit();return}let r=M(t.options);if(!r){t.setResult([e,i]).exit();return}let l=r.diff;t.setResult([l(e,i),0,2]).exit()};D.filterName="texts";let N=function(t){if(t.nested)return;let e=t.delta;if(2!==e[2])return;let i=M(t.options,!0).patch;t.setResult(i(t.left,e[0])).exit()};N.filterName="texts";let I=function(t){let e,i,s,r;let l=null,n=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,o=t.split("\n");for(e=0,i=o.length;e<i;e++){let t=(s=o[e]).slice(0,1);"@"===t?(l=n.exec(s),o[e]="@@ -"+l[3]+","+l[4]+" +"+l[1]+","+l[2]+" @@"):"+"===t?(o[e]="-"+o[e].slice(1),"+"===o[e-1].slice(0,1)&&(r=o[e],o[e]=o[e-1],o[e-1]=r)):"-"===t&&(o[e]="+"+o[e].slice(1))}return o.join("\n")},$=function(t){if(t.nested)return;let e=t.delta;2===e[2]&&t.setResult([I(e[0]),0,2]).exit()};$.filterName="texts";class P{constructor(t){this.processor=new l(t),this.processor.pipe(new n("diff").append(g,f,C,D,v,A).shouldHaveResult()),this.processor.pipe(new n("patch").append(y,F,d,N,m,z).shouldHaveResult()),this.processor.pipe(new n("reverse").append(b,j,p,$,x,E).shouldHaveResult())}options(t){return this.processor.options(t)}diff(t,e){return this.processor.process(new h(t,e))}patch(t,e){return this.processor.process(new u(t,e))}reverse(t){return this.processor.process(new c(t))}unpatch(t,e){return this.patch(t,this.reverse(e))}clone(t){return a(t)}}function B(t,e){return s||(s=new P),s.patch(t,e)}function W(t){return s||(s=new P),s.clone(t)}var U=i(19054),G=Symbol.for("ui.streamable.value");function H(t){return!function(t){var e;if(!((e=t)&&"object"==typeof e&&"type"in e&&e.type===G))throw Error("Invalid value: this hook only accepts values created via `createStreamableValue`.")}(t),{[Symbol.asyncIterator](){let e=t,i=e.curr,s=!1,r=!0;return{async next(){if(s)return{value:i,done:!0};if(void 0!==(e=await e).error)throw e.error;if("curr"in e||e.diff){if(e.diff){if(0===e.diff[0]){if("string"!=typeof i)throw Error("Invalid patch: can only append to string types. This is a bug in the AI SDK.");i+=e.diff[1]}}else i=e.curr;if(!e.next)return s=!0,{value:i,done:!1}}return e.next?(e=e.next,r&&(r=!1,void 0===i))?this.next():{value:i,done:!1}:{value:i,done:!0}}}}}}var V=async t=>{let{c:e,n:i}=t,s=await i;return s.done?s.value:s.append?(0,U.jsxs)(U.Fragment,{children:[e,(0,U.jsx)(r.Suspense,{fallback:s.value,children:(0,U.jsx)(V,{c:s.value,n:s.next})})]}):(0,U.jsx)(r.Suspense,{fallback:s.value,children:(0,U.jsx)(V,{c:s.value,n:s.next})})},q=r.createContext(null),K=r.createContext(void 0),J=r.createContext(null),X=r.createContext(null);function Y(t){let{children:e,initialUIState:i,initialAIState:s,initialAIStatePatch:l,wrappedActions:n,wrappedSyncUIState:o}=t,a=r.useState(i),h=a[1],u=l?r.use(l):void 0;s=r.useMemo(()=>u?B(W(s),u):s,[s,u]);let c=r.useState(s),f=c[1],d=r.useRef(c[0]);r.useEffect(()=>{d.current=c[0]},[c[0]]);let p=r.useMemo(()=>Object.fromEntries(Object.entries(n).map(t=>{let[e,i]=t;return[e,async function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];let r=d.current,[l,n]=await i(r,...e);return(async()=>{let t=await l;void 0!==t&&c[1](B(W(r),t))})(),n}]})),[n]),g=r.useMemo(()=>o?async()=>{let t=d.current,[e,i]=await o(t);void 0!==i&&h(i);let s=await e;void 0!==s&&f(B(W(t),s))}:()=>{},[o]);return(0,U.jsx)(K.Provider,{value:c,children:(0,U.jsx)(q.Provider,{value:a,children:(0,U.jsx)(J.Provider,{value:p,children:(0,U.jsx)(X.Provider,{value:g,children:e})})})})}},44578:(t,e,i)=>{"use strict";i.d(e,{z:()=>g});var s=i(37534);let r="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,l=new Set,n="object"==typeof s&&s?s:{},o=(t,e,i,s)=>{"function"==typeof n.emitWarning?n.emitWarning(t,e,i,s):console.error(`[${i}] ${e}: ${t}`)},a=globalThis.AbortController,h=globalThis.AbortSignal;if(void 0===a){h=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(t,e){this._onabort.push(e)}},a=class{constructor(){e()}signal=new h;abort(t){if(!this.signal.aborted){for(let e of(this.signal.reason=t,this.signal.aborted=!0,this.signal._onabort))e(t);this.signal.onabort?.(t)}}};let t=n.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=()=>{t&&(t=!1,o("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}let u=t=>!l.has(t);Symbol("type");let c=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),f=t=>c(t)?t<=256?Uint8Array:t<=65536?Uint16Array:t<=4294967296?Uint32Array:t<=Number.MAX_SAFE_INTEGER?d:null:null;class d extends Array{constructor(t){super(t),this.fill(0)}}class p{heap;length;static #t=!1;static create(t){let e=f(t);if(!e)return[];p.#t=!0;let i=new p(t,e);return p.#t=!1,i}constructor(t,e){if(!p.#t)throw TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}}class g{#e;#i;#s;#r;#l;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#n;#o;#a;#h;#u;#c;#f;#d;#p;#g;#v;#m;#y;#x;#b;#_;#S;static unsafeExposeInternals(t){return{starts:t.#y,ttls:t.#x,sizes:t.#m,keyMap:t.#a,keyList:t.#h,valList:t.#u,next:t.#c,prev:t.#f,get head(){return t.#d},get tail(){return t.#p},free:t.#g,isBackgroundFetch:e=>t.#w(e),backgroundFetch:(e,i,s,r)=>t.#T(e,i,s,r),moveToTail:e=>t.#k(e),indexes:e=>t.#A(e),rindexes:e=>t.#L(e),isStale:e=>t.#z(e)}}get max(){return this.#e}get maxSize(){return this.#i}get calculatedSize(){return this.#o}get size(){return this.#n}get fetchMethod(){return this.#l}get dispose(){return this.#s}get disposeAfter(){return this.#r}constructor(t){let{max:e=0,ttl:i,ttlResolution:s=1,ttlAutopurge:r,updateAgeOnGet:n,updateAgeOnHas:a,allowStale:h,dispose:d,disposeAfter:v,noDisposeOnSet:m,noUpdateTTL:y,maxSize:x=0,maxEntrySize:b=0,sizeCalculation:_,fetchMethod:S,noDeleteOnFetchRejection:w,noDeleteOnStaleGet:T,allowStaleOnFetchRejection:k,allowStaleOnFetchAbort:A,ignoreFetchAbort:L}=t;if(0!==e&&!c(e))throw TypeError("max option must be a nonnegative integer");let z=e?f(e):Array;if(!z)throw Error("invalid max value: "+e);if(this.#e=e,this.#i=x,this.maxEntrySize=b||this.#i,this.sizeCalculation=_,this.sizeCalculation){if(!this.#i&&!this.maxEntrySize)throw TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw TypeError("sizeCalculation set to non-function")}if(void 0!==S&&"function"!=typeof S)throw TypeError("fetchMethod must be a function if specified");if(this.#l=S,this.#_=!!S,this.#a=new Map,this.#h=Array(e).fill(void 0),this.#u=Array(e).fill(void 0),this.#c=new z(e),this.#f=new z(e),this.#d=0,this.#p=0,this.#g=p.create(e),this.#n=0,this.#o=0,"function"==typeof d&&(this.#s=d),"function"==typeof v?(this.#r=v,this.#v=[]):(this.#r=void 0,this.#v=void 0),this.#b=!!this.#s,this.#S=!!this.#r,this.noDisposeOnSet=!!m,this.noUpdateTTL=!!y,this.noDeleteOnFetchRejection=!!w,this.allowStaleOnFetchRejection=!!k,this.allowStaleOnFetchAbort=!!A,this.ignoreFetchAbort=!!L,0!==this.maxEntrySize){if(0!==this.#i&&!c(this.#i))throw TypeError("maxSize must be a positive integer if specified");if(!c(this.maxEntrySize))throw TypeError("maxEntrySize must be a positive integer if specified");this.#F()}if(this.allowStale=!!h,this.noDeleteOnStaleGet=!!T,this.updateAgeOnGet=!!n,this.updateAgeOnHas=!!a,this.ttlResolution=c(s)||0===s?s:1,this.ttlAutopurge=!!r,this.ttl=i||0,this.ttl){if(!c(this.ttl))throw TypeError("ttl must be a positive integer if specified");this.#E()}if(0===this.#e&&0===this.ttl&&0===this.#i)throw TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#i){let t="LRU_CACHE_UNBOUNDED";u(t)&&(l.add(t),o("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",t,g))}}getRemainingTTL(t){return this.#a.has(t)?1/0:0}#E(){let t=new d(this.#e),e=new d(this.#e);this.#x=t,this.#y=e,this.#R=(i,s,l=r.now())=>{if(e[i]=0!==s?l:0,t[i]=s,0!==s&&this.ttlAutopurge){let t=setTimeout(()=>{this.#z(i)&&this.delete(this.#h[i])},s+1);t.unref&&t.unref()}},this.#j=i=>{e[i]=0!==t[i]?r.now():0},this.#C=(r,l)=>{if(t[l]){let n=t[l],o=e[l];if(!n||!o)return;r.ttl=n,r.start=o,r.now=i||s();let a=r.now-o;r.remainingTTL=n-a}};let i=0,s=()=>{let t=r.now();if(this.ttlResolution>0){i=t;let e=setTimeout(()=>i=0,this.ttlResolution);e.unref&&e.unref()}return t};this.getRemainingTTL=r=>{let l=this.#a.get(r);if(void 0===l)return 0;let n=t[l],o=e[l];return n&&o?n-((i||s())-o):1/0},this.#z=r=>{let l=e[r],n=t[r];return!!n&&!!l&&(i||s())-l>n}}#j=()=>{};#C=()=>{};#R=()=>{};#z=()=>!1;#F(){let t=new d(this.#e);this.#o=0,this.#m=t,this.#O=e=>{this.#o-=t[e],t[e]=0},this.#M=(t,e,i,s)=>{if(this.#w(e))return 0;if(!c(i)){if(s){if("function"!=typeof s)throw TypeError("sizeCalculation must be a function");if(!c(i=s(e,t)))throw TypeError("sizeCalculation return invalid (expect positive integer)")}else throw TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.")}return i},this.#D=(e,i,s)=>{if(t[e]=i,this.#i){let i=this.#i-t[e];for(;this.#o>i;)this.#N(!0)}this.#o+=t[e],s&&(s.entrySize=i,s.totalCalculatedSize=this.#o)}}#O=t=>{};#D=(t,e,i)=>{};#M=(t,e,i,s)=>{if(i||s)throw TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#A({allowStale:t=this.allowStale}={}){if(this.#n)for(let e=this.#p;this.#I(e)&&((t||!this.#z(e))&&(yield e),e!==this.#d);)e=this.#f[e]}*#L({allowStale:t=this.allowStale}={}){if(this.#n)for(let e=this.#d;this.#I(e)&&((t||!this.#z(e))&&(yield e),e!==this.#p);)e=this.#c[e]}#I(t){return void 0!==t&&this.#a.get(this.#h[t])===t}*entries(){for(let t of this.#A())void 0===this.#u[t]||void 0===this.#h[t]||this.#w(this.#u[t])||(yield[this.#h[t],this.#u[t]])}*rentries(){for(let t of this.#L())void 0===this.#u[t]||void 0===this.#h[t]||this.#w(this.#u[t])||(yield[this.#h[t],this.#u[t]])}*keys(){for(let t of this.#A()){let e=this.#h[t];void 0===e||this.#w(this.#u[t])||(yield e)}}*rkeys(){for(let t of this.#L()){let e=this.#h[t];void 0===e||this.#w(this.#u[t])||(yield e)}}*values(){for(let t of this.#A())void 0===this.#u[t]||this.#w(this.#u[t])||(yield this.#u[t])}*rvalues(){for(let t of this.#L())void 0===this.#u[t]||this.#w(this.#u[t])||(yield this.#u[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(let i of this.#A()){let s=this.#u[i],r=this.#w(s)?s.__staleWhileFetching:s;if(void 0!==r&&t(r,this.#h[i],this))return this.get(this.#h[i],e)}}forEach(t,e=this){for(let i of this.#A()){let s=this.#u[i],r=this.#w(s)?s.__staleWhileFetching:s;void 0!==r&&t.call(e,r,this.#h[i],this)}}rforEach(t,e=this){for(let i of this.#L()){let s=this.#u[i],r=this.#w(s)?s.__staleWhileFetching:s;void 0!==r&&t.call(e,r,this.#h[i],this)}}purgeStale(){let t=!1;for(let e of this.#L({allowStale:!0}))this.#z(e)&&(this.delete(this.#h[e]),t=!0);return t}info(t){let e=this.#a.get(t);if(void 0===e)return;let i=this.#u[e],s=this.#w(i)?i.__staleWhileFetching:i;if(void 0===s)return;let l={value:s};if(this.#x&&this.#y){let t=this.#x[e],i=this.#y[e];if(t&&i){let e=t-(r.now()-i);l.ttl=e,l.start=Date.now()}}return this.#m&&(l.size=this.#m[e]),l}dump(){let t=[];for(let e of this.#A({allowStale:!0})){let i=this.#h[e],s=this.#u[e],l=this.#w(s)?s.__staleWhileFetching:s;if(void 0===l||void 0===i)continue;let n={value:l};if(this.#x&&this.#y){n.ttl=this.#x[e];let t=r.now()-this.#y[e];n.start=Math.floor(Date.now()-t)}this.#m&&(n.size=this.#m[e]),t.unshift([i,n])}return t}load(t){for(let[e,i]of(this.clear(),t)){if(i.start){let t=Date.now()-i.start;i.start=r.now()-t}this.set(e,i.value,i)}}set(t,e,i={}){if(void 0===e)return this.delete(t),this;let{ttl:s=this.ttl,start:r,noDisposeOnSet:l=this.noDisposeOnSet,sizeCalculation:n=this.sizeCalculation,status:o}=i,{noUpdateTTL:a=this.noUpdateTTL}=i,h=this.#M(t,e,i.size||0,n);if(this.maxEntrySize&&h>this.maxEntrySize)return o&&(o.set="miss",o.maxEntrySizeExceeded=!0),this.delete(t),this;let u=0===this.#n?void 0:this.#a.get(t);if(void 0===u)u=0===this.#n?this.#p:0!==this.#g.length?this.#g.pop():this.#n===this.#e?this.#N(!1):this.#n,this.#h[u]=t,this.#u[u]=e,this.#a.set(t,u),this.#c[this.#p]=u,this.#f[u]=this.#p,this.#p=u,this.#n++,this.#D(u,h,o),o&&(o.set="add"),a=!1;else{this.#k(u);let i=this.#u[u];if(e!==i){if(this.#_&&this.#w(i)){i.__abortController.abort(Error("replaced"));let{__staleWhileFetching:e}=i;void 0!==e&&!l&&(this.#b&&this.#s?.(e,t,"set"),this.#S&&this.#v?.push([e,t,"set"]))}else!l&&(this.#b&&this.#s?.(i,t,"set"),this.#S&&this.#v?.push([i,t,"set"]));if(this.#O(u),this.#D(u,h,o),this.#u[u]=e,o){o.set="replace";let t=i&&this.#w(i)?i.__staleWhileFetching:i;void 0!==t&&(o.oldValue=t)}}else o&&(o.set="update")}if(0===s||this.#x||this.#E(),this.#x&&(a||this.#R(u,s,r),o&&this.#C(o,u)),!l&&this.#S&&this.#v){let t;let e=this.#v;for(;t=e?.shift();)this.#r?.(...t)}return this}pop(){try{for(;this.#n;){let t=this.#u[this.#d];if(this.#N(!0),this.#w(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(void 0!==t)return t}}finally{if(this.#S&&this.#v){let t;let e=this.#v;for(;t=e?.shift();)this.#r?.(...t)}}}#N(t){let e=this.#d,i=this.#h[e],s=this.#u[e];return this.#_&&this.#w(s)?s.__abortController.abort(Error("evicted")):(this.#b||this.#S)&&(this.#b&&this.#s?.(s,i,"evict"),this.#S&&this.#v?.push([s,i,"evict"])),this.#O(e),t&&(this.#h[e]=void 0,this.#u[e]=void 0,this.#g.push(e)),1===this.#n?(this.#d=this.#p=0,this.#g.length=0):this.#d=this.#c[e],this.#a.delete(i),this.#n--,e}has(t,e={}){let{updateAgeOnHas:i=this.updateAgeOnHas,status:s}=e,r=this.#a.get(t);if(void 0!==r){let t=this.#u[r];if(this.#w(t)&&void 0===t.__staleWhileFetching)return!1;if(!this.#z(r))return i&&this.#j(r),s&&(s.has="hit",this.#C(s,r)),!0;s&&(s.has="stale",this.#C(s,r))}else s&&(s.has="miss");return!1}peek(t,e={}){let{allowStale:i=this.allowStale}=e,s=this.#a.get(t);if(void 0===s||!i&&this.#z(s))return;let r=this.#u[s];return this.#w(r)?r.__staleWhileFetching:r}#T(t,e,i,s){let r=void 0===e?void 0:this.#u[e];if(this.#w(r))return r;let l=new a,{signal:n}=i;n?.addEventListener("abort",()=>l.abort(n.reason),{signal:l.signal});let o={signal:l.signal,options:i,context:s},h=(s,r=!1)=>{let{aborted:n}=l.signal,a=i.ignoreFetchAbort&&void 0!==s;return(i.status&&(n&&!r?(i.status.fetchAborted=!0,i.status.fetchError=l.signal.reason,a&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),!n||a||r)?(this.#u[e]===c&&(void 0===s?c.__staleWhileFetching?this.#u[e]=c.__staleWhileFetching:this.delete(t):(i.status&&(i.status.fetchUpdated=!0),this.set(t,s,o.options))),s):u(l.signal.reason)},u=s=>{let{aborted:r}=l.signal,n=r&&i.allowStaleOnFetchAbort,o=n||i.allowStaleOnFetchRejection,a=o||i.noDeleteOnFetchRejection;if(this.#u[e]!==c||(a&&void 0!==c.__staleWhileFetching?n||(this.#u[e]=c.__staleWhileFetching):this.delete(t)),o)return i.status&&void 0!==c.__staleWhileFetching&&(i.status.returnedStale=!0),c.__staleWhileFetching;if(c.__returned===c)throw s};i.status&&(i.status.fetchDispatched=!0);let c=new Promise((e,s)=>{let n=this.#l?.(t,r,o);n&&n instanceof Promise&&n.then(t=>e(void 0===t?void 0:t),s),l.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(e(void 0),i.allowStaleOnFetchAbort&&(e=t=>h(t,!0)))})}).then(h,t=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=t),u(t))),f=Object.assign(c,{__abortController:l,__staleWhileFetching:r,__returned:void 0});return void 0===e?(this.set(t,f,{...o.options,status:void 0}),e=this.#a.get(t)):this.#u[e]=f,f}#w(t){return!!this.#_&&!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof a}async fetch(t,e={}){let{allowStale:i=this.allowStale,updateAgeOnGet:s=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,ttl:l=this.ttl,noDisposeOnSet:n=this.noDisposeOnSet,size:o=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:c=this.allowStaleOnFetchRejection,ignoreFetchAbort:f=this.ignoreFetchAbort,allowStaleOnFetchAbort:d=this.allowStaleOnFetchAbort,context:p,forceRefresh:g=!1,status:v,signal:m}=e;if(!this.#_)return v&&(v.fetch="get"),this.get(t,{allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:r,status:v});let y={allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:r,ttl:l,noDisposeOnSet:n,size:o,sizeCalculation:a,noUpdateTTL:h,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:c,allowStaleOnFetchAbort:d,ignoreFetchAbort:f,status:v,signal:m},x=this.#a.get(t);if(void 0===x){v&&(v.fetch="miss");let e=this.#T(t,x,y,p);return e.__returned=e}{let e=this.#u[x];if(this.#w(e)){let t=i&&void 0!==e.__staleWhileFetching;return v&&(v.fetch="inflight",t&&(v.returnedStale=!0)),t?e.__staleWhileFetching:e.__returned=e}let r=this.#z(x);if(!g&&!r)return v&&(v.fetch="hit"),this.#k(x),s&&this.#j(x),v&&this.#C(v,x),e;let l=this.#T(t,x,y,p),n=void 0!==l.__staleWhileFetching&&i;return v&&(v.fetch=r?"stale":"refresh",n&&r&&(v.returnedStale=!0)),n?l.__staleWhileFetching:l.__returned=l}}get(t,e={}){let{allowStale:i=this.allowStale,updateAgeOnGet:s=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,status:l}=e,n=this.#a.get(t);if(void 0!==n){let e=this.#u[n],o=this.#w(e);return(l&&this.#C(l,n),this.#z(n))?(l&&(l.get="stale"),o)?(l&&i&&void 0!==e.__staleWhileFetching&&(l.returnedStale=!0),i?e.__staleWhileFetching:void 0):(r||this.delete(t),l&&i&&(l.returnedStale=!0),i?e:void 0):(l&&(l.get="hit"),o)?e.__staleWhileFetching:(this.#k(n),s&&this.#j(n),e)}l&&(l.get="miss")}#$(t,e){this.#f[e]=t,this.#c[t]=e}#k(t){t!==this.#p&&(t===this.#d?this.#d=this.#c[t]:this.#$(this.#f[t],this.#c[t]),this.#$(this.#p,t),this.#p=t)}delete(t){let e=!1;if(0!==this.#n){let i=this.#a.get(t);if(void 0!==i){if(e=!0,1===this.#n)this.clear();else{this.#O(i);let e=this.#u[i];if(this.#w(e)?e.__abortController.abort(Error("deleted")):(this.#b||this.#S)&&(this.#b&&this.#s?.(e,t,"delete"),this.#S&&this.#v?.push([e,t,"delete"])),this.#a.delete(t),this.#h[i]=void 0,this.#u[i]=void 0,i===this.#p)this.#p=this.#f[i];else if(i===this.#d)this.#d=this.#c[i];else{let t=this.#f[i];this.#c[t]=this.#c[i];let e=this.#c[i];this.#f[e]=this.#f[i]}this.#n--,this.#g.push(i)}}}if(this.#S&&this.#v?.length){let t;let e=this.#v;for(;t=e?.shift();)this.#r?.(...t)}return e}clear(){for(let t of this.#L({allowStale:!0})){let e=this.#u[t];if(this.#w(e))e.__abortController.abort(Error("deleted"));else{let i=this.#h[t];this.#b&&this.#s?.(e,i,"delete"),this.#S&&this.#v?.push([e,i,"delete"])}}if(this.#a.clear(),this.#u.fill(void 0),this.#h.fill(void 0),this.#x&&this.#y&&(this.#x.fill(0),this.#y.fill(0)),this.#m&&this.#m.fill(0),this.#d=0,this.#p=0,this.#g.length=0,this.#o=0,this.#n=0,this.#S&&this.#v){let t;let e=this.#v;for(;t=e?.shift();)this.#r?.(...t)}}}}}]);